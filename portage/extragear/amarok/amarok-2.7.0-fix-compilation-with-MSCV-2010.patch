 .../collections/db/sql/mysqlecollection/CMakeLists.txt       |  1 +
 .../db/sql/mysqlecollection/MySqlEmbeddedStorage.h           | 12 +++++++++++-
 src/core-impl/playlists/types/file/PlaylistFile.h            |  2 +-
 3 files changed, 13 insertions(+), 2 deletions(-)

diff --git a/src/core-impl/collections/db/sql/mysqlecollection/CMakeLists.txt b/src/core-impl/collections/db/sql/mysqlecollection/CMakeLists.txt
index e000d50..7169c3e 100644
--- a/src/core-impl/collections/db/sql/mysqlecollection/CMakeLists.txt
+++ b/src/core-impl/collections/db/sql/mysqlecollection/CMakeLists.txt
@@ -8,6 +8,7 @@ set( amarok_collection-mysqlecollection_PART_SRCS
      MySqlEmbeddedStorage.cpp
 )
 
+add_definitions(-DMAKE_AMAROK_SQLCOLLECTION_MYSQLE_LIB)
 kde4_add_plugin(amarok_collection-mysqlecollection ${amarok_collection-mysqlecollection_PART_SRCS})
 
 STRING(REPLACE "-Wl,--fatal-warnings" "" CMAKE_SHARED_LINKER_FLAGS_NOFATALWARN "${CMAKE_SHARED_LINKER_FLAGS}")
diff --git a/src/core-impl/collections/db/sql/mysqlecollection/MySqlEmbeddedStorage.h b/src/core-impl/collections/db/sql/mysqlecollection/MySqlEmbeddedStorage.h
index 4839129..5fef1cb 100644
--- a/src/core-impl/collections/db/sql/mysqlecollection/MySqlEmbeddedStorage.h
+++ b/src/core-impl/collections/db/sql/mysqlecollection/MySqlEmbeddedStorage.h
@@ -22,11 +22,21 @@
 #include <core/collections/support/SqlStorage.h>
 #include <core-impl/collections/db/sql/mysql-shared/MySqlStorage.h>
 
+#ifndef AMAROK_SQLCOLLECTION_MYSQLE_EXPORT
+# if defined(MAKE_AMAROK_SQLCOLLECTION_MYSQLE_LIB)
+   /* We are building this library */
+#   define AMAROK_SQLCOLLECTION_MYSQLE_EXPORT KDE_EXPORT
+# else
+   /* We are using this library */
+#   define AMAROK_SQLCOLLECTION_MYSQLE_EXPORT KDE_IMPORT
+# endif
+#endif
+
 /**
  * Implements a MySqlCollection using a MySQL Embedded Server
  */
 
-class AMAROK_SQLCOLLECTION_EXPORT MySqlEmbeddedStorage : public MySqlStorage
+class AMAROK_SQLCOLLECTION_MYSQLE_EXPORT MySqlEmbeddedStorage : public MySqlStorage
 {
     public:
         /** Creates a new SqlStorage.
diff --git a/src/core-impl/playlists/types/file/PlaylistFile.h b/src/core-impl/playlists/types/file/PlaylistFile.h
index 0358196..b04670a 100644
--- a/src/core-impl/playlists/types/file/PlaylistFile.h
+++ b/src/core-impl/playlists/types/file/PlaylistFile.h
@@ -25,13 +25,13 @@
 #include <QMutex>
 #include <QSemaphore>
 
-class PlaylistProvider;
 class QFile;
 
 namespace Playlists
 {
     class PlaylistFile;
     class PlaylistFileLoaderJob;
+    class PlaylistProvider;
 
     typedef KSharedPtr<PlaylistFile> PlaylistFilePtr;
     typedef QList<PlaylistFilePtr> PlaylistFileList;
