diff -Nru -x '*~' sqlite-amalgamation-3080100.orig/CMakeLists.txt sqlite-amalgamation-3080100/CMakeLists.txt
--- sqlite-amalgamation-3080100.orig/CMakeLists.txt	1970-01-01 01:00:00.000000000 +0100
+++ sqlite-amalgamation-3080100/CMakeLists.txt	2015-08-19 16:35:51.757560800 +0200
@@ -0,0 +1,59 @@
+project( Sqlite )
+cmake_minimum_required( VERSION 2.10 )
+
+set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} ${CMAKE_CURRENT_SOURCE_DIR}/cmake/modules)
+
+# see https://www.sqlite.org/compile.html
+# options taken over from fedora
+option(SQLITE_DISABLE_DIRSYNC "directory syncs are disabled" ON)
+option(SQLITE_ENABLE_COLUMN_METADATA "API that provides convenient access to meta-data about tables and queries" ON)
+option(SQLITE_ENABLE_FTS3 "version 3 of the full-text search engine is added" ON)
+option(SQLITE_ENABLE_FTS4 "versions 3 and 4 of the full-text search engine is added" ON)
+option(SQLITE_ENABLE_RTREE "support for the R*Tree index extension" ON)
+option(SQLITE_SECURE_DELETE "changes the default setting of the secure_delete pragma" ON)
+option(SQLITE_ENABLE_UNLOCK_NOTIFY "enables the sqlite3_unlock_notify() interface" ON)
+option(SQLITE_ENABLE_DBSTAT_VTAB "enables the dbstat virtual table" ON)
+option(SQLITE_ENABLE_FTS3_PARENTHESIS "modifies the query pattern parser in FTS3 such that it supports operators AND and NOT" ON)
+
+foreach(_option DIRSYNC)
+    if(SQLITE_DISABLE_${_option})
+        add_definitions(-DSQLITE_DISABLE_${_option}=1)
+    endif()
+endforeach()
+
+foreach(_option COLUMN_METADATA FTS3 FTS4 RTREE DELETE UNLOCK_NOTIFY DBSTAT_VTAB FTS3_PARENTHESIS)
+    if(SQLITE_ENABLE_${_option})
+        add_definitions(-DSQLITE_ENABLE_${_option}=1)
+    endif()
+endforeach()
+
+add_definitions(-DSQLITE_WIN32_MALLOC)
+
+if(STATIC_LIBRARY)
+    set(SQLITE3_STATIC 1)
+    set(LIBRARY_TYPE STATIC)
+    add_definitions(-DSQLITE3_STATIC_LIBS)
+else()
+    set(LIBRARY_TYPE SHARED)
+endif()
+
+configure_file(sqlite3.h ${CMAKE_CURRENT_BINARY_DIR}/sqlite3.h)
+configure_file(sqlite3.c ${CMAKE_CURRENT_BINARY_DIR}/sqlite3.c)
+include_directories(${CMAKE_CURRENT_BINARY_DIR})
+
+set( sqlite_HEADER ${CMAKE_CURRENT_BINARY_DIR}/sqlite3.h sqlite3ext.h )
+
+set( libsqlite_SRC ${CMAKE_CURRENT_BINARY_DIR}/sqlite3.c  )
+set( sqlite_SRC shell.c )
+
+add_library( libsqlite3 ${LIBRARY_TYPE}  ${libsqlite_SRC} )
+set_target_properties( libsqlite3 PROPERTIES RUNTIME_OUTPUT_NAME libsqlite ARCHIVE_OUTPUT_NAME sqlite3 )
+install( TARGETS libsqlite3 RUNTIME DESTINATION bin LIBRARY DESTINATION lib ARCHIVE DESTINATION lib )
+
+add_executable( sqlite3_bin ${sqlite_SRC} )
+target_link_libraries( sqlite3_bin libsqlite3 )
+set_target_properties( sqlite3_bin PROPERTIES RUNTIME_OUTPUT_NAME sqlite3 ARCHIVE_OUTPUT_NAME sqlite3_bin )
+
+install( TARGETS sqlite3_bin RUNTIME DESTINATION bin LIBRARY DESTINATION lib ARCHIVE DESTINATION lib )
+
+install( FILES ${sqlite_HEADER} DESTINATION include )
diff -Nru -x '*~' sqlite-amalgamation-3080100.orig/shell.c sqlite-amalgamation-3080100/shell.c
--- sqlite-amalgamation-3080100.orig/shell.c	2015-08-19 16:38:44.152421200 +0200
+++ sqlite-amalgamation-3080100/shell.c	2015-08-17 23:28:58.275229700 +0200
@@ -32,7 +32,7 @@
 #include <string.h>
 #include <stdio.h>
 #include <assert.h>
-#include "sqlite3.h"
+#include <sqlite3.h>
 #include <ctype.h>
 #include <stdarg.h>
 
diff -Nru -x '*~' sqlite-amalgamation-3080100.orig/sqlite3.c sqlite-amalgamation-3080100/sqlite3.c
--- sqlite-amalgamation-3080100.orig/sqlite3.c	2015-08-19 16:38:44.192423500 +0200
+++ sqlite-amalgamation-3080100/sqlite3.c	2015-08-17 23:28:58.363234700 +0200
@@ -23,7 +23,19 @@
 # define SQLITE_PRIVATE static
 #endif
 #ifndef SQLITE_API
-# define SQLITE_API
+# ifdef _MSC_VER
+#cmakedefine SQLITE3_STATIC 1
+#  if defined(SQLITE3_STATIC)
+    /* No export/import for static libraries */
+#   define SQLITE_API
+#  elif defined(libsqlite3_EXPORTS)
+#   define SQLITE_API __declspec(dllexport)
+#  else
+#   define SQLITE_API __declspec(dllimport)
+#  endif
+# else
+#  define SQLITE_API
+# endif
 #endif
 /************** Begin file sqlite3.h *****************************************/
 /*
diff -Nru -x '*~' sqlite-amalgamation-3080100.orig/sqlite3.h sqlite-amalgamation-3080100/sqlite3.h
--- sqlite-amalgamation-3080100.orig/sqlite3.h	2015-08-19 16:38:44.201424000 +0200
+++ sqlite-amalgamation-3080100/sqlite3.h	2015-08-17 23:28:58.379235700 +0200
@@ -49,8 +49,21 @@
 # define SQLITE_EXTERN extern
 #endif
 
+#cmakedefine SQLITE3_STATIC 1
+
 #ifndef SQLITE_API
-# define SQLITE_API
+# ifdef _MSC_VER
+#  if defined(SQLITE3_STATIC)
+    /* No export/import for static libraries */
+#   define SQLITE_API
+#  elif defined(libsqlite3_EXPORTS)
+#   define SQLITE_API __declspec(dllexport)
+#  else
+#   define SQLITE_API __declspec(dllimport)
+#  endif
+# else
+#  define SQLITE_API
+# endif
 #endif
 
 
